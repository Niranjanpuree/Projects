<loading-gif [show]="showLoadingGif"></loading-gif>

<div class="drawer-left">
    <span></span>
    <div>
        <main class="clearfix">
            <div>
                <div class="add-form">
                    <h2>
                        Filters
                        <a class="btn larger" (click)="clearAllFacets()">CLEAR</a>
                        <a class="btn icon search larger" (click)="searchVehicleToBedConfigs()">SEARCH BED SYSTEMS</a>
                    </h2>

                    <div class="clearfix">
                        <div class="input-blocks clearfix">

                            <div style="width: 215px;">
                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Regions</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.regions)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Regions" (input)="filterRegions($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let region of regionFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="region.name" [(ngModel)]="region.isSelected" (change)="onItemSelected($event, vehicleToBedConfigSearchViewModel.facets.regions)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{region.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong>Years</strong>

                                    <div class="select white-select" style="width: 100px;">
                                        <select [(ngModel)]="selectedStartYear" (ngModelChange)="onYearSelected()">
                                            <option value="0">--From--</option>
                                            <option *ngFor="let year of startYearFacet" [value]="year">{{year}}</option>
                                        </select>
                                        <div class="select__arrow white-select__arrow"></div>
                                    </div>
                                    <span class="fa fa-caret-right"></span><!--pushkar-->
                                    <div class="select white-select" style="width: 100px;">
                                        <select [(ngModel)]="selectedEndYear" (ngModelChange)="onYearSelected()">
                                            <option value="0">--To--</option>
                                            <option *ngFor="let year of endYearFacet" [value]="year">{{year}}</option>
                                        </select>
                                        <div class="select__arrow white-select__arrow"></div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Submodels</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.subModels, false)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Submodels" (input)="filterSubModels($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let subModel of subModelFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="subModel.name" [(ngModel)]="subModel.isSelected">
                                                    <div class="control__indicator"></div>
                                                    <span>{{subModel.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div style="width: 215px;">

                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Vehicle Type Groups</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.vehicleTypeGroups)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Vehicle Type Groups" (input)="filterVehicleTypeGroups($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let item of vehicleTypeGroupFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="item.name" [(ngModel)]="item.isSelected" (change)="onItemSelected($event, vehicleToBedConfigSearchViewModel.facets.vehicleTypeGroups)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{item.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Makes</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.makes)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Makes" (input)="filterMakes($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let make of makeFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="make.name" [(ngModel)]="make.isSelected" (change)="onItemSelected($event, vehicleToBedConfigSearchViewModel.facets.makes)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{make.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div style="width: 215px;">
                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Vehicle Types</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.vehicleTypes)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Vehicle Types" (input)="filterVehicleTypes($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let item of vehicleTypeFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="item.name" [(ngModel)]="item.isSelected" (change)="onItemSelected($event, vehicleToBedConfigSearchViewModel.facets.vehicleTypes)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{item.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Models</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToBedConfigSearchViewModel.facets.models)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Models" (input)="filterModels($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let model of modelFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="model.name" [(ngModel)]="model.isSelected" (change)="onItemSelected($event, vehicleToBedConfigSearchViewModel.facets.models)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{model.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </main>
    </div>
    <!-- Left split screen end -->
</div>
<!-- Right split screen start -->
<!-- Breadcrumb start -->
<div class="breadcrumb">
    <div class="center">
        <a routerLink="/system/search" class="back">Return to bed system search</a>
    </div>
</div>
<!-- Breadcrumb end -->
<div id="main">
    <!-- Main start -->
    <main class="clearfix">
        <div class="center">
            <!-- Existing Bed systems start -->
            <div class="table-wrap">
                <h2 class="clearfix">
                    Existing Bed Systems
                </h2>
                <div class="ctable">
                    <table>
                        <thead>
                            <tr>
                                <td>Bed Config ID</td>
                                <td>Bed Length (ID)</td>
                                <td>Bed Length Metric</td>
                                <td>Bed Type (ID)</td>
                            </tr>
                        </thead>
                        <tbody *ngIf="existingBedConfig">
                            <tr>
                                <td>{{existingBedConfig.id}}</td>
                                <td>{{existingBedConfig.length}} ({{existingBedConfig.bedLengthId}})</td>
                                <td>{{existingBedConfig.bedLengthMetric}}</td>
                                <td>{{existingBedConfig.bedTypeName}} ({{existingBedConfig.bedTypeId}})</td>

                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Modify bed system form start -->
            <div class="add-form">
                <h2>
                    Select Replacement Bed System
                    <div class="filter-search" style="float:right;">
                        <input type="text" class="cinput" [(ngModel)]="bedConfigIdSearchText" (keypress)="onBedConfigIdKeyPress($event)" placeholder="Bed System Search">
                        <input type="submit" value="" (click)="onBedConfigIdSearch()">
                    </div>
                </h2>
                <div class="clearfix">
                    <div class="input-blocks clearfix">
                        <div style="width:100px">
                            <strong>Bed Config ID</strong>
                            <div class="select white-select" style="width: 220px;">
                                <label *ngIf="!replaceBedConfig || replaceBedConfig.id <= 0">N/A</label>
                                <label *ngIf="replaceBedConfig && replaceBedConfig.id > 0">{{replaceBedConfig.id}}</label>
                            </div>
                        </div>
                        <div>
                            <strong>Bed Length (ID)</strong>

                            <div class="select white-select" style="width: 220px;">
                                <select [disabled]="!bedLengths || bedLengths.length==0" [(ngModel)]="replaceBedConfig.bedLengthId" (ngModelChange)="onChangeBedLength(replaceBedConfig.bedLengthId)">
                                    <option value="-1" *ngIf="!bedLengths">Loading...</option>
                                    <option value="-1" *ngIf="bedLengths">--Select Bed Length--</option>
                                    <option *ngFor="let item of bedLengths" [value]="item.id">{{item.length}} ({{item.id}})</option>
                                </select>
                                <div class="select__arrow white-select__arrow"></div>
                            </div>
                        </div>
                        <div>
                            <strong>Bed Type (ID)</strong>

                            <div class="select white-select" style="width: 220px;">
                                <select [disabled]="!bedTypes || bedTypes.length==0" [(ngModel)]="replaceBedConfig.bedTypeId" (ngModelChange)="onChangeBedType(replaceBedConfig.bedTypeId,replaceBedConfig.bedLengthId)">
                                    <option value="-1" *ngIf="!bedTypes">Loading...</option>
                                    <option value="-1" *ngIf="bedTypes">--Select Bed Type--</option>
                                    <option *ngFor="let item of bedTypes" [value]="item.id">{{item.name}} ({{item.id}})</option>
                                </select>
                                <div class="select__arrow white-select__arrow"></div>
                            </div>
                        </div>
                    </div>

                </div>
                <div>
                    <input type="submit" value="VIEW AFFECTED ASSOCIATIONS" class="btn blue larger" (click)="onViewAffectedAssociations()">
                </div>
            </div>
            <!-- Select associations for replacement start -->
            <div class="table-wrap">
                <h2 class="clearfix" *ngIf="existingBedConfig && existingBedConfig.vehicleToBedConfigs">
                    Select Associations for Replacement
                </h2>
                <div class="ctable" *ngIf="existingBedConfig && existingBedConfig.vehicleToBedConfigs">
                    <ac-grid #vehicleToBedConfigGrid [dataSource]="existingBedConfig.vehicleToBedConfigs" #gd="acGrid"
                              columns='[
                 { "header":" ", "selectable": {"selected": false}},
                
                 { "header":"Vehicle to Bed Config ID","field":"id","sortable":true,"sortedByDesc":true},
                 { "header":"Bed Config ID",                "field":"bedConfigId",    "sortable":true},
                 { "header":"Base Vehicle (Year, Make, Model)","field":"vehicle.yearId","sortable":true},
                 { "header":"Vehicle (Submodel, Region)","field":"vehicle.subModelName","sortable":true},
                 { "header":"Bed Length (ID)","field":"bedConfig.length","sortable":true},
                 { "header":"Bed Length Metric","field":"bedConfig.bedLengthMetric","sortable":true},
                 { "header":"Bed Type (ID)", "field":"bedConfig.bedTypeName", "sortable":true}
                 ]'
                             initialSortBy='[{"field": "id", "orderByDesc": true}]'
                             paging='{"pageSize": 10, "numberOfPagesOnPageList" : 10}'
                             (selectAllChangedEvent)="onSelectAllVehicleToBedConfig($event)" [selectAllChecked]="isSelectAllVehicleToBedConfig"
                             [thresholdRecordCount]="thresholdRecordCount">
                        <tr *ngFor="let vechicleToBedConfig of gd.items">
                            <td>
                                <label class="control control--checkbox green-checkbox">
                                    <input type="checkbox" [(ngModel)]="vechicleToBedConfig.isSelected" (change)="onVehicleToBedConfigSelected(vechicleToBedConfig)" />
                                    <div class="control__indicator"></div>
                                </label>
                            </td>
	                        <td>{{vechicleToBedConfig.id}}</td>
                            <td>{{vechicleToBedConfig.bedConfigId}}</td>
                            <td>{{vechicleToBedConfig.vehicle.yearId}}, {{vechicleToBedConfig.vehicle.makeName}}, {{vechicleToBedConfig.vehicle.modelName}}</td>
                            <td>{{vechicleToBedConfig.vehicle.subModelName}}, {{vechicleToBedConfig.vehicle.regionName}}</td>
                            <td>{{vechicleToBedConfig.bedConfig.length}} ({{vechicleToBedConfig.bedConfig.bedLengthId}})</td>
                            <td>{{vechicleToBedConfig.bedConfig.bedLengthMetric}}</td>
                            <td>{{vechicleToBedConfig.bedConfig.bedTypeName}} ({{vechicleToBedConfig.bedConfig.bedTypeId}})</td>
                        </tr>
                    </ac-grid>
                </div>


                <!-- Submit and cancel button start -->
                <div class="btns">
                    <input type="submit" value="CONTINUE" class="btn  larger" (click)="onContinue()">
                    <input type="reset" value="CANCEL" class="btn larger transparent" routerLink="/system/search">
                </div>

            </div>
        </div>

    </main>
    <!-- Main end -->
</div>