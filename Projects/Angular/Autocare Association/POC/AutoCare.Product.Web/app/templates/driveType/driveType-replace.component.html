<loading-gif [show]="showLoadingGif"></loading-gif>

<div class="drawer-left">
    <span></span>
    <div>
        <main class="clearfix">
            <div>
                <div class="add-form">
                    <h2>
                        Filters
                        <a class="btn larger" (click)="clearAllFacets()">CLEAR</a>
                        <a class="btn icon search larger" (click)="searchVehicleToDriveTypes()">SEARCH DRIVE TYPES</a>
                    </h2>

                    <div class="clearfix">
                        <div class="input-blocks clearfix">

                            <div style="width: 215px;">
                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Regions</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.regions)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Regions" (input)="filterRegions($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let region of regionFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="region.name" [(ngModel)]="region.isSelected" (change)="onItemSelected($event, vehicleToDriveTypeSearchViewModel.facets.regions)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{region.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong>Years</strong>

                                    <div class="select white-select" style="width: 100px;">
                                        <select [(ngModel)]="selectedStartYear" (ngModelChange)="onYearSelected()">
                                            <option value="0">--From--</option>
                                            <option *ngFor="let year of startYearFacet" [value]="year">{{year}}</option>
                                        </select>
                                        <div class="select__arrow white-select__arrow"></div>
                                    </div>
                                    <span class="fa fa-caret-right"></span><!--pushkar-->
                                    <div class="select white-select" style="width: 100px;">
                                        <select [(ngModel)]="selectedEndYear" (ngModelChange)="onYearSelected()">
                                            <option value="0">--To--</option>
                                            <option *ngFor="let year of endYearFacet" [value]="year">{{year}}</option>
                                        </select>
                                        <div class="select__arrow white-select__arrow"></div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Submodels</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.subModels, false)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Submodels" (input)="filterSubModels($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let subModel of subModelFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="subModel.name" [(ngModel)]="subModel.isSelected">
                                                    <div class="control__indicator"></div>
                                                    <span>{{subModel.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div style="width: 215px;">

                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Vehicle Type Groups</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.vehicleTypeGroups)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Vehicle Type Groups" (input)="filterVehicleTypeGroups($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let item of vehicleTypeGroupFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="item.name" [(ngModel)]="item.isSelected" (change)="onItemSelected($event, vehicleToDriveTypeSearchViewModel.facets.vehicleTypeGroups)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{item.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Makes</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.makes)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Makes" (input)="filterMakes($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let make of makeFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="make.name" [(ngModel)]="make.isSelected" (change)="onItemSelected($event, vehicleToDriveTypeSearchViewModel.facets.makes)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{make.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div style="width: 215px;">
                                <div style="margin-top: 10px;">
                                    <strong class="float-left">Vehicle Types</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.vehicleTypes)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Vehicle Types" (input)="filterVehicleTypes($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let item of vehicleTypeFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="item.name" [(ngModel)]="item.isSelected" (change)="onItemSelected($event, vehicleToDriveTypeSearchViewModel.facets.vehicleTypes)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{item.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <strong class="float-left">Models</strong>
                                    <a class="float-right" (click)="clearFacet(vehicleToDriveTypeSearchViewModel.facets.models)" style="text-decoration:underline; cursor:pointer;">Clear</a>
                                    <div class="clearfix"></div>
                                    <div class="filter-search">
                                        <input type="text" class="cinput" placeholder="Search Models" (input)="filterModels($event)" />
                                        <input type="submit" value="">
                                    </div>

                                    <div class="clearfix"></div>

                                    <div class="checkbox-wrap after-search" style="overflow: auto; height: 160px;">
                                        <ul>
                                            <li *ngFor="let model of modelFacet">
                                                <label class="control control--checkbox green-checkbox">
                                                    <input type="checkbox" [value]="model.name" [(ngModel)]="model.isSelected" (change)="onItemSelected($event, vehicleToDriveTypeSearchViewModel.facets.models)">
                                                    <div class="control__indicator"></div>
                                                    <span>{{model.name}}</span>
                                                </label>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </main>
    </div>
    <!-- Left split screen end -->
</div>
<!-- Right split screen start -->
<!-- Breadcrumb start -->
<div class="breadcrumb">
    <div class="center">
        <a routerLink="/system/search" class="back">Return to drive type search</a>
    </div>
</div>
<!-- Breadcrumb end -->
<div id="main">
    <!-- Main start -->
    <main class="clearfix">
        <div class="center">
            <!-- Existing Drive Type systems start -->
            <div class="table-wrap">
                <h2 class="clearfix">
                    Existing Drive Type
                </h2>
                <div class="ctable">
                    <table>
                        <thead>
                            <tr>
                                <td>Drive Type ID</td>
                                <td>Drive Type</td>
                            </tr>
                        </thead>
                        <tbody *ngIf="existingDriveType">
                            <tr>
                                <td>{{existingDriveType.id}}</td>
                                <td>{{existingDriveType.name}}</td> 
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Modify drive type form start -->
            <div class="add-form">
                <h2>
                    Select Replacement Drive Type
                    <div class="filter-search" style="float:right;">
                        <input type="text" class="cinput" [(ngModel)]="driveTypeIdSearchText" (keypress)="onDriveTypeIdKeyPress($event)" placeholder="Drive Type Search">
                        <input type="submit" value="" (click)="onDriveTypeIdSearch()">
                    </div>
                </h2>
                <div class="clearfix">
                    <div class="input-blocks clearfix">
                        <div style="width:100px">
                            <strong>Drive Type ID</strong>
                            <div class="select white-select" style="width: 220px;">
                                <label *ngIf="!replaceDriveType || replaceDriveType.id <= 0">N/A</label>
                                <label *ngIf="replaceDriveType && replaceDriveType.id > 0">{{replaceDriveType.id}}</label>
                            </div>
                        </div>
                        <div>
                            <strong>Drive Type</strong>

                            <div class="select white-select" style="width: 220px;">
                                <select [disabled]="!driveTypes || driveTypes.length==0" [(ngModel)]="replaceDriveType.id" (ngModelChange)="onChangeDriveType(replaceDriveType.id)">
                                    <option value="-1" *ngIf="!driveTypes">Loading...</option>
                                    <option value="-1" *ngIf="driveTypes">--Select Drive Type Name--</option>
                                    <option *ngFor="let item of driveTypes" [value]="item.id">{{item.name}} ({{item.id}})</option>
                                </select>
                                <div class="select__arrow white-select__arrow"></div>
                            </div>
                        </div>
                    </div>

                </div>
                <div>
                    <input type="submit" value="VIEW AFFECTED ASSOCIATIONS" class="btn blue larger" (click)="onViewAffectedAssociations()">
                </div>
            </div>
            <!-- Select associations for replacement start -->
            <div class="table-wrap">
                <h2 class="clearfix" *ngIf="existingDriveType && existingDriveType.vehicleToDriveTypes">
                    Select Associations for Replacement
                </h2>
                <div class="ctable" *ngIf="existingDriveType && existingDriveType.vehicleToDriveTypes">
                    <ac-grid #vehicleToDriveTypeGrid [dataSource]="existingDriveType.vehicleToDriveTypes" #gd="acGrid"
                              columns='[
                 { "header":" ", "selectable": {"selected": false}},
                 { "header":"Vehicle to Drive Type ID","field":"id","sortable":true,"sortedByDesc":true},
                 { "header":"Drive Type ID",              "field":"driveTypeId",       "sortable":true}, 
                 { "header":"Base Vehicle (Year, Make, Model)","field":"vehicle.yearId","sortable":true},
                 { "header":"Vehicle (Submodel, Region)","field":"vehicle.subModelName","sortable":true},
                 { "header":"Drive Type","field":"driveType.name","sortable":true}
                 ]'
                             initialSortBy='[{"field": "id", "orderByDesc": true}]'
                             paging='{"pageSize": 10, "numberOfPagesOnPageList" : 10}'
                             (selectAllChangedEvent)="onSelectAllVehicleToDriveType($event)" [selectAllChecked]="isSelectAllVehicleToDriveType"
                             [thresholdRecordCount]="thresholdRecordCount">
                        <tr *ngFor="let vechicleToDriveType of gd.items">
                            <td>
                                <label class="control control--checkbox green-checkbox">
                                    <input type="checkbox" [(ngModel)]="vechicleToDriveType.isSelected" (change)="onVehicleToDriveTypeSelected(vechicleToDriveType)" />
                                    <div class="control__indicator"></div>
                                </label>
                            </td>
	                        <td>{{vechicleToDriveType.id}}</td>
                             <td>{{vechicleToDriveType.driveTypeId}}</td>
                            <td>{{vechicleToDriveType.vehicle.yearId}}, {{vechicleToDriveType.vehicle.makeName}}, {{vechicleToDriveType.vehicle.modelName}}</td>
                            <td>{{vechicleToDriveType.vehicle.subModelName}}, {{vechicleToDriveType.vehicle.regionName}}</td>
                            <td>{{vechicleToDriveType.driveType.name}}</td>
                        </tr>
                    </ac-grid>
                </div>


                <!-- Submit and cancel button start -->
                <div class="btns">
                    <input type="submit" value="CONTINUE" class="btn  larger" (click)="onContinue()">
                    <input type="reset" value="CANCEL" class="btn larger transparent" routerLink="/system/search">
                </div>

            </div>
            
        </div>

    </main>
    <!-- Main end -->
</div>
